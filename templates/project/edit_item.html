{% extends 'layouts/base.html' %}

{% block title %} Edit Item {% endblock title %}

{% block content %}
<div class="container mt-5">
    <h3>Edit Item in Project: {{ project.name }}</h3>

    <form action="{{ url_for('projectItem_blueprint.update_item', project_id=project.id, item_id=item.id) }}"
        method="POST" enctype="multipart/form-data">
        <div class="border rounded p-3 mb-3">
            <div class="form-group">
                <div class="d-flex">
                    <div class="d-flex flex-column mr-2">
                        <label>Current Image</label>
                        <img id="previewImage" src="{{ url_for('static', filename='uploads/' + item.image) }}"
                            class="img-thumbnail mt-2" style="width: 200px; height: 200px;" alt="Item Image">
                    </div>
                </div>

            </div>
            <div class="form-group">
                <input type="file" name="image" class="form-control-file" id="imageInput">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea name="description" class="form-control" required>{{ item.description }}</textarea>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Update Item</button>
    </form>
</div>
{% endblock content %}

{% block javascripts %}
<script>
    document.getElementById('imageInput').addEventListener('change', function (e) {
        const preview = document.getElementById('previewImage');
        const file = e.target.files[0];

        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        } else {
            preview.style.display = 'none';
        }
    });
</script>
{% endblock javascripts %}